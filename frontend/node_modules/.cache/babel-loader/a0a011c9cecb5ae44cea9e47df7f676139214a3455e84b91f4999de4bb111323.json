{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createBlock as _createBlock, resolveDirective as _resolveDirective, withDirectives as _withDirectives } from \"vue\";\nvar _hoisted_1 = {\n  \"class\": \"profile-container\"\n};\nvar _hoisted_2 = {\n  \"class\": \"action-buttons mt-20\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_el_descriptions_item = _resolveComponent(\"el-descriptions-item\");\n  var _component_el_descriptions = _resolveComponent(\"el-descriptions\");\n  var _component_el_button = _resolveComponent(\"el-button\");\n  var _component_el_empty = _resolveComponent(\"el-empty\");\n  var _component_el_card = _resolveComponent(\"el-card\");\n  var _directive_loading = _resolveDirective(\"loading\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[2] || (_cache[2] = _createElementVNode(\"h1\", {\n    \"class\": \"page-title\"\n  }, \"用户资料\", -1 /* HOISTED */)), _withDirectives((_openBlock(), _createBlock(_component_el_card, null, {\n    \"default\": _withCtx(function () {\n      return [$setup.user ? (_openBlock(), _createElementBlock(_Fragment, {\n        key: 0\n      }, [_createVNode(_component_el_descriptions, {\n        column: 1,\n        border: \"\"\n      }, {\n        \"default\": _withCtx(function () {\n          return [_createVNode(_component_el_descriptions_item, {\n            label: \"用户名\"\n          }, {\n            \"default\": _withCtx(function () {\n              return [_createTextVNode(_toDisplayString($setup.user.username), 1 /* TEXT */)];\n            }),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_el_descriptions_item, {\n            label: \"邮箱\"\n          }, {\n            \"default\": _withCtx(function () {\n              return [_createTextVNode(_toDisplayString($setup.user.email), 1 /* TEXT */)];\n            }),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_el_descriptions_item, {\n            label: \"角色\"\n          }, {\n            \"default\": _withCtx(function () {\n              return [_createTextVNode(_toDisplayString($setup.user.role === 'admin' ? '管理员' : '普通用户'), 1 /* TEXT */)];\n            }),\n            _: 1 /* STABLE */\n          })];\n        }),\n        _: 1 /* STABLE */\n      }), _createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_el_button, {\n        type: \"primary\",\n        onClick: _cache[0] || (_cache[0] = function ($event) {\n          return _ctx.$router.push('/change-password');\n        })\n      }, {\n        \"default\": _withCtx(function () {\n          return _cache[1] || (_cache[1] = [_createTextVNode(\" 修改密码 \")]);\n        }),\n        _: 1 /* STABLE */\n      })])], 64 /* STABLE_FRAGMENT */)) : !$setup.loading ? (_openBlock(), _createBlock(_component_el_empty, {\n        key: 1,\n        description: \"未找到用户资料\"\n      })) : _createCommentVNode(\"v-if\", true)];\n    }),\n    _: 1 /* STABLE */\n  })), [[_directive_loading, $setup.loading]])]);\n}","map":{"version":3,"names":["_createElementBlock","_hoisted_1","_createElementVNode","_createBlock","_component_el_card","_withCtx","$setup","user","_Fragment","key","_createVNode","_component_el_descriptions","column","border","_component_el_descriptions_item","label","_createTextVNode","_toDisplayString","username","_","email","role","_hoisted_2","_component_el_button","type","onClick","_cache","$event","_ctx","$router","push","loading","_component_el_empty","description","_createCommentVNode"],"sources":["E:\\GoLand20240404\\Project\\student_management\\frontend\\src\\views\\auth\\Profile.vue"],"sourcesContent":["<template>\r\n  <div class=\"profile-container\">\r\n    <h1 class=\"page-title\">用户资料</h1>\r\n    \r\n    <el-card v-loading=\"loading\">\r\n      <template v-if=\"user\">\r\n        <el-descriptions :column=\"1\" border>\r\n          <el-descriptions-item label=\"用户名\">\r\n            {{ user.username }}\r\n          </el-descriptions-item>\r\n          \r\n          <el-descriptions-item label=\"邮箱\">\r\n            {{ user.email }}\r\n          </el-descriptions-item>\r\n          \r\n          <el-descriptions-item label=\"角色\">\r\n            {{ user.role === 'admin' ? '管理员' : '普通用户' }}\r\n          </el-descriptions-item>\r\n        </el-descriptions>\r\n        \r\n        <div class=\"action-buttons mt-20\">\r\n          <el-button \r\n            type=\"primary\" \r\n            @click=\"$router.push('/change-password')\"\r\n          >\r\n            修改密码\r\n          </el-button>\r\n        </div>\r\n      </template>\r\n      \r\n      <el-empty \r\n        v-else-if=\"!loading\" \r\n        description=\"未找到用户资料\"\r\n      />\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, computed, onMounted } from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport { ElMessage } from 'element-plus'\r\n\r\nexport default {\r\n  name: 'Profile',\r\n  setup() {\r\n    const store = useStore()\r\n    const loading = ref(false)\r\n    \r\n    // Get user from store\r\n    const user = computed(() => store.getters['auth/user'])\r\n    \r\n    // Fetch user profile\r\n    const fetchProfile = async () => {\r\n      if (user.value) return // Already have user data\r\n      \r\n      loading.value = true\r\n      try {\r\n        // Get token from localStorage\r\n        const token = localStorage.getItem('token')\r\n        if (token) {\r\n          await store.dispatch('auth/restoreSession', token)\r\n        } else {\r\n          ElMessage.error('Not authenticated')\r\n        }\r\n      } catch (error) {\r\n        console.error('Error fetching profile:', error)\r\n        ElMessage.error('Failed to load profile')\r\n      } finally {\r\n        loading.value = false\r\n      }\r\n    }\r\n    \r\n    // Fetch data on component mount\r\n    onMounted(fetchProfile)\r\n    \r\n    return {\r\n      user,\r\n      loading\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.action-buttons {\r\n  display: flex;\r\n  gap: 10px;\r\n}\r\n</style>\r\n\r\n<style>\r\n/* Add any additional styles here */\r\n</style>\r\n "],"mappings":";;;EACO,SAAM;AAAmB;;EAmBnB,SAAM;AAAsB;;;;;;;;uBAnBvCA,mBAAA,CAkCM,OAlCNC,UAkCM,G,0BAjCJC,mBAAA,CAAgC;IAA5B,SAAM;EAAY,GAAC,MAAI,sB,+BAE3BC,YAAA,CA8BUC,kBAAA;IAlCd,WAAAC,QAAA,CAIM;MAAA,OA2Be,CA1BCC,MAAA,CAAAC,IAAI,I,cAApBP,mBAAA,CAuBWQ,SAAA;QA5BjBC,GAAA;MAAA,IAMQC,YAAA,CAYkBC,0BAAA;QAZAC,MAAM,EAAE,CAAC;QAAEC,MAAM,EAAN;;QANrC,WAAAR,QAAA,CAOU;UAAA,OAEuB,CAFvBK,YAAA,CAEuBI,+BAAA;YAFDC,KAAK,EAAC;UAAK;YAP3C,WAAAV,QAAA,CAQY;cAAA,OAAmB,CAR/BW,gBAAA,CAAAC,gBAAA,CAQeX,MAAA,CAAAC,IAAI,CAACW,QAAQ,iB;;YAR5BC,CAAA;cAWUT,YAAA,CAEuBI,+BAAA;YAFDC,KAAK,EAAC;UAAI;YAX1C,WAAAV,QAAA,CAYY;cAAA,OAAgB,CAZ5BW,gBAAA,CAAAC,gBAAA,CAYeX,MAAA,CAAAC,IAAI,CAACa,KAAK,iB;;YAZzBD,CAAA;cAeUT,YAAA,CAEuBI,+BAAA;YAFDC,KAAK,EAAC;UAAI;YAf1C,WAAAV,QAAA,CAgBY;cAAA,OAA4C,CAhBxDW,gBAAA,CAAAC,gBAAA,CAgBeX,MAAA,CAAAC,IAAI,CAACc,IAAI,8C;;YAhBxBF,CAAA;;;QAAAA,CAAA;UAoBQjB,mBAAA,CAOM,OAPNoB,UAOM,GANJZ,YAAA,CAKYa,oBAAA;QAJVC,IAAI,EAAC,SAAS;QACbC,OAAK,EAAAC,MAAA,QAAAA,MAAA,gBAAAC,MAAA;UAAA,OAAEC,IAAA,CAAAC,OAAO,CAACC,IAAI;QAAA;;QAvBhC,WAAAzB,QAAA,CAwBW;UAAA,OAEDqB,MAAA,QAAAA,MAAA,OA1BVV,gBAAA,CAwBW,QAED,E;;QA1BVG,CAAA;2CA+BoBb,MAAA,CAAAyB,OAAO,I,cADrB5B,YAAA,CAGE6B,mBAAA;QAjCRvB,GAAA;QAgCQwB,WAAW,EAAC;YAhCpBC,mBAAA,e;;IAAAf,CAAA;6BAIwBb,MAAA,CAAAyB,OAAO,E","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}