{"ast":null,"code":"import { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, createCommentVNode as _createCommentVNode, resolveDirective as _resolveDirective, openBlock as _openBlock, createBlock as _createBlock, withDirectives as _withDirectives, toDisplayString as _toDisplayString, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"class-list-container\"\n};\nconst _hoisted_2 = {\n  class: \"page-header\"\n};\nconst _hoisted_3 = {\n  key: 0,\n  class: \"text-danger\"\n};\nconst _hoisted_4 = {\n  class: \"dialog-footer\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_table_column = _resolveComponent(\"el-table-column\");\n  const _component_el_table = _resolveComponent(\"el-table\");\n  const _component_el_empty = _resolveComponent(\"el-empty\");\n  const _component_el_card = _resolveComponent(\"el-card\");\n  const _component_el_dialog = _resolveComponent(\"el-dialog\");\n  const _directive_loading = _resolveDirective(\"loading\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_cache[5] || (_cache[5] = _createElementVNode(\"h1\", {\n    class: \"page-title\"\n  }, \"Classes\", -1 /* HOISTED */)), _createVNode(_component_el_button, {\n    type: \"primary\",\n    onClick: _cache[0] || (_cache[0] = $event => _ctx.$router.push('/classes/new'))\n  }, {\n    default: _withCtx(() => _cache[4] || (_cache[4] = [_createTextVNode(\" Add New Class \")])),\n    _: 1 /* STABLE */\n  })]), _createCommentVNode(\" Classes Table \"), _createVNode(_component_el_card, null, {\n    default: _withCtx(() => [_withDirectives((_openBlock(), _createBlock(_component_el_table, {\n      data: $setup.classes,\n      style: {\n        \"width\": \"100%\"\n      },\n      border: \"\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_table_column, {\n        prop: \"name\",\n        label: \"Class Name\",\n        sortable: \"\"\n      }), _createVNode(_component_el_table_column, {\n        prop: \"description\",\n        label: \"Description\",\n        \"show-overflow-tooltip\": \"\"\n      }), _createVNode(_component_el_table_column, {\n        prop: \"student_count\",\n        label: \"Students\",\n        width: \"100\",\n        sortable: \"\"\n      }), _createVNode(_component_el_table_column, {\n        label: \"Actions\",\n        width: \"250\",\n        fixed: \"right\"\n      }, {\n        default: _withCtx(scope => [_createVNode(_component_el_button, {\n          size: \"small\",\n          type: \"primary\",\n          onClick: $event => _ctx.$router.push(`/classes/${scope.row.id}`)\n        }, {\n          default: _withCtx(() => _cache[6] || (_cache[6] = [_createTextVNode(\" View \")])),\n          _: 2 /* DYNAMIC */\n        }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"]), _createVNode(_component_el_button, {\n          size: \"small\",\n          type: \"warning\",\n          onClick: $event => _ctx.$router.push(`/classes/${scope.row.id}/edit`)\n        }, {\n          default: _withCtx(() => _cache[7] || (_cache[7] = [_createTextVNode(\" Edit \")])),\n          _: 2 /* DYNAMIC */\n        }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"]), _createVNode(_component_el_button, {\n          size: \"small\",\n          type: \"danger\",\n          onClick: $event => $setup.confirmDelete(scope.row)\n        }, {\n          default: _withCtx(() => _cache[8] || (_cache[8] = [_createTextVNode(\" Delete \")])),\n          _: 2 /* DYNAMIC */\n        }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"])]),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"data\"])), [[_directive_loading, $setup.loading]]), _createCommentVNode(\" Empty state \"), $setup.classes.length === 0 && !$setup.loading ? (_openBlock(), _createBlock(_component_el_empty, {\n      key: 0,\n      description: \"No classes found\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_el_button, {\n        type: \"primary\",\n        onClick: _cache[1] || (_cache[1] = $event => _ctx.$router.push('/classes/new'))\n      }, {\n        default: _withCtx(() => _cache[9] || (_cache[9] = [_createTextVNode(\" Create First Class \")])),\n        _: 1 /* STABLE */\n      })]),\n      _: 1 /* STABLE */\n    })) : _createCommentVNode(\"v-if\", true)]),\n    _: 1 /* STABLE */\n  }), _createCommentVNode(\" Delete Confirmation Dialog \"), _createVNode(_component_el_dialog, {\n    modelValue: $setup.deleteDialog.visible,\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $setup.deleteDialog.visible = $event),\n    title: \"Confirm Delete\",\n    width: \"30%\"\n  }, {\n    footer: _withCtx(() => [_createElementVNode(\"span\", _hoisted_4, [_createVNode(_component_el_button, {\n      onClick: _cache[2] || (_cache[2] = $event => $setup.deleteDialog.visible = false)\n    }, {\n      default: _withCtx(() => _cache[12] || (_cache[12] = [_createTextVNode(\"Cancel\")])),\n      _: 1 /* STABLE */\n    }), _createVNode(_component_el_button, {\n      type: \"danger\",\n      onClick: $setup.deleteClass,\n      loading: $setup.deleteDialog.loading,\n      disabled: $setup.deleteDialog.class?.student_count > 0\n    }, {\n      default: _withCtx(() => _cache[13] || (_cache[13] = [_createTextVNode(\" Delete \")])),\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"onClick\", \"loading\", \"disabled\"])])]),\n    default: _withCtx(() => [_createElementVNode(\"span\", null, [_createTextVNode(\" Are you sure you want to delete class \\\"\" + _toDisplayString($setup.deleteDialog.class?.name) + \"\\\"? \", 1 /* TEXT */), _cache[10] || (_cache[10] = _createElementVNode(\"br\", null, null, -1 /* HOISTED */)), _cache[11] || (_cache[11] = _createElementVNode(\"br\", null, null, -1 /* HOISTED */)), $setup.deleteDialog.class?.student_count > 0 ? (_openBlock(), _createElementBlock(\"strong\", _hoisted_3, \" Warning: This class has \" + _toDisplayString($setup.deleteDialog.class.student_count) + \" students. You cannot delete a class that has students. \", 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)])]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\"])]);\n}","map":{"version":3,"names":["class","key","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createVNode","_component_el_button","type","onClick","_cache","$event","_ctx","$router","push","default","_withCtx","_createTextVNode","_","_createCommentVNode","_component_el_card","_createBlock","_component_el_table","data","$setup","classes","style","border","_component_el_table_column","prop","label","sortable","width","fixed","scope","size","row","id","confirmDelete","loading","length","_component_el_empty","description","_component_el_dialog","modelValue","deleteDialog","visible","title","footer","_hoisted_4","deleteClass","disabled","student_count","_toDisplayString","name","_hoisted_3"],"sources":["E:\\GoLand20240404\\Project\\student_management\\frontend\\src\\views\\classes\\ClassList.vue"],"sourcesContent":["<template>\r\n  <div class=\"class-list-container\">\r\n    <div class=\"page-header\">\r\n      <h1 class=\"page-title\">Classes</h1>\r\n      <el-button type=\"primary\" @click=\"$router.push('/classes/new')\">\r\n        Add New Class\r\n      </el-button>\r\n    </div>\r\n    \r\n    <!-- Classes Table -->\r\n    <el-card>\r\n      <el-table \r\n        :data=\"classes\" \r\n        v-loading=\"loading\" \r\n        style=\"width: 100%\"\r\n        border\r\n      >\r\n        <el-table-column prop=\"name\" label=\"Class Name\" sortable />\r\n        <el-table-column prop=\"description\" label=\"Description\" show-overflow-tooltip />\r\n        <el-table-column prop=\"student_count\" label=\"Students\" width=\"100\" sortable />\r\n        <el-table-column label=\"Actions\" width=\"250\" fixed=\"right\">\r\n          <template #default=\"scope\">\r\n            <el-button \r\n              size=\"small\" \r\n              type=\"primary\" \r\n              @click=\"$router.push(`/classes/${scope.row.id}`)\"\r\n            >\r\n              View\r\n            </el-button>\r\n            <el-button \r\n              size=\"small\" \r\n              type=\"warning\" \r\n              @click=\"$router.push(`/classes/${scope.row.id}/edit`)\"\r\n            >\r\n              Edit\r\n            </el-button>\r\n            <el-button \r\n              size=\"small\" \r\n              type=\"danger\" \r\n              @click=\"confirmDelete(scope.row)\"\r\n            >\r\n              Delete\r\n            </el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      \r\n      <!-- Empty state -->\r\n      <el-empty \r\n        v-if=\"classes.length === 0 && !loading\" \r\n        description=\"No classes found\"\r\n      >\r\n        <el-button type=\"primary\" @click=\"$router.push('/classes/new')\">\r\n          Create First Class\r\n        </el-button>\r\n      </el-empty>\r\n    </el-card>\r\n    \r\n    <!-- Delete Confirmation Dialog -->\r\n    <el-dialog\r\n      v-model=\"deleteDialog.visible\"\r\n      title=\"Confirm Delete\"\r\n      width=\"30%\"\r\n    >\r\n      <span>\r\n        Are you sure you want to delete class \"{{ deleteDialog.class?.name }}\"?\r\n        <br><br>\r\n        <strong v-if=\"deleteDialog.class?.student_count > 0\" class=\"text-danger\">\r\n          Warning: This class has {{ deleteDialog.class.student_count }} students. \r\n          You cannot delete a class that has students.\r\n        </strong>\r\n      </span>\r\n      <template #footer>\r\n        <span class=\"dialog-footer\">\r\n          <el-button @click=\"deleteDialog.visible = false\">Cancel</el-button>\r\n          <el-button \r\n            type=\"danger\" \r\n            @click=\"deleteClass\" \r\n            :loading=\"deleteDialog.loading\"\r\n            :disabled=\"deleteDialog.class?.student_count > 0\"\r\n          >\r\n            Delete\r\n          </el-button>\r\n        </span>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, reactive, computed, onMounted } from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport { ElMessage } from 'element-plus'\r\n\r\nexport default {\r\n  name: 'ClassList',\r\n  setup() {\r\n    const store = useStore()\r\n    const loading = ref(false)\r\n    \r\n    // Get classes from store\r\n    const classes = computed(() => store.getters['classes/allClasses'])\r\n    \r\n    // Delete dialog state\r\n    const deleteDialog = reactive({\r\n      visible: false,\r\n      class: null,\r\n      loading: false\r\n    })\r\n    \r\n    // Fetch classes\r\n    const fetchClasses = async () => {\r\n      loading.value = true\r\n      try {\r\n        await store.dispatch('classes/fetchClasses')\r\n      } catch (error) {\r\n        console.error('Error fetching classes:', error)\r\n        ElMessage.error('Failed to load classes')\r\n      } finally {\r\n        loading.value = false\r\n      }\r\n    }\r\n    \r\n    // Delete class\r\n    const confirmDelete = (classData) => {\r\n      deleteDialog.class = classData\r\n      deleteDialog.visible = true\r\n    }\r\n    \r\n    const deleteClass = async () => {\r\n      if (!deleteDialog.class) return\r\n      \r\n      // Check if class has students\r\n      if (deleteDialog.class.student_count > 0) {\r\n        ElMessage.error('Cannot delete a class that has students')\r\n        return\r\n      }\r\n      \r\n      deleteDialog.loading = true\r\n      try {\r\n        await store.dispatch('classes/deleteClass', deleteDialog.class.id)\r\n        ElMessage.success('Class deleted successfully')\r\n        deleteDialog.visible = false\r\n      } catch (error) {\r\n        console.error('Error deleting class:', error)\r\n        if (error.response && error.response.status === 409) {\r\n          ElMessage.error('Cannot delete a class that has associated students')\r\n        } else {\r\n          ElMessage.error('Failed to delete class')\r\n        }\r\n      } finally {\r\n        deleteDialog.loading = false\r\n      }\r\n    }\r\n    \r\n    // Fetch data on component mount\r\n    onMounted(fetchClasses)\r\n    \r\n    return {\r\n      classes,\r\n      loading,\r\n      deleteDialog,\r\n      confirmDelete,\r\n      deleteClass\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.page-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.text-danger {\r\n  color: #F56C6C;\r\n}\r\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}