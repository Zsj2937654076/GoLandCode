{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport { createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, createCommentVNode as _createCommentVNode, resolveDirective as _resolveDirective, openBlock as _openBlock, createBlock as _createBlock, withDirectives as _withDirectives, toDisplayString as _toDisplayString, createElementBlock as _createElementBlock } from \"vue\";\nvar _hoisted_1 = {\n  \"class\": \"class-list-container\"\n};\nvar _hoisted_2 = {\n  \"class\": \"page-header\"\n};\nvar _hoisted_3 = {\n  key: 0,\n  \"class\": \"text-danger\"\n};\nvar _hoisted_4 = {\n  \"class\": \"dialog-footer\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_el_button = _resolveComponent(\"el-button\");\n  var _component_el_table_column = _resolveComponent(\"el-table-column\");\n  var _component_el_table = _resolveComponent(\"el-table\");\n  var _component_el_empty = _resolveComponent(\"el-empty\");\n  var _component_el_card = _resolveComponent(\"el-card\");\n  var _component_el_dialog = _resolveComponent(\"el-dialog\");\n  var _directive_loading = _resolveDirective(\"loading\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_cache[5] || (_cache[5] = _createElementVNode(\"h1\", {\n    \"class\": \"page-title\"\n  }, \"Classes\", -1 /* HOISTED */)), _createVNode(_component_el_button, {\n    type: \"primary\",\n    onClick: _cache[0] || (_cache[0] = function ($event) {\n      return _ctx.$router.push('/classes/new');\n    })\n  }, {\n    \"default\": _withCtx(function () {\n      return _cache[4] || (_cache[4] = [_createTextVNode(\" Add New Class \")]);\n    }),\n    _: 1 /* STABLE */\n  })]), _createCommentVNode(\" Classes Table \"), _createVNode(_component_el_card, null, {\n    \"default\": _withCtx(function () {\n      return [_withDirectives((_openBlock(), _createBlock(_component_el_table, {\n        data: $setup.classes,\n        style: {\n          \"width\": \"100%\"\n        },\n        border: \"\"\n      }, {\n        \"default\": _withCtx(function () {\n          return [_createVNode(_component_el_table_column, {\n            prop: \"name\",\n            label: \"Class Name\",\n            sortable: \"\"\n          }), _createVNode(_component_el_table_column, {\n            prop: \"description\",\n            label: \"Description\",\n            \"show-overflow-tooltip\": \"\"\n          }), _createVNode(_component_el_table_column, {\n            prop: \"student_count\",\n            label: \"Students\",\n            width: \"100\",\n            sortable: \"\"\n          }), _createVNode(_component_el_table_column, {\n            label: \"Actions\",\n            width: \"250\",\n            fixed: \"right\"\n          }, {\n            \"default\": _withCtx(function (scope) {\n              return [_createVNode(_component_el_button, {\n                size: \"small\",\n                type: \"primary\",\n                onClick: function onClick($event) {\n                  return _ctx.$router.push(\"/classes/\".concat(scope.row.id));\n                }\n              }, {\n                \"default\": _withCtx(function () {\n                  return _cache[6] || (_cache[6] = [_createTextVNode(\" View \")]);\n                }),\n                _: 2 /* DYNAMIC */\n              }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"]), _createVNode(_component_el_button, {\n                size: \"small\",\n                type: \"warning\",\n                onClick: function onClick($event) {\n                  return _ctx.$router.push(\"/classes/\".concat(scope.row.id, \"/edit\"));\n                }\n              }, {\n                \"default\": _withCtx(function () {\n                  return _cache[7] || (_cache[7] = [_createTextVNode(\" Edit \")]);\n                }),\n                _: 2 /* DYNAMIC */\n              }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"]), _createVNode(_component_el_button, {\n                size: \"small\",\n                type: \"danger\",\n                onClick: function onClick($event) {\n                  return $setup.confirmDelete(scope.row);\n                }\n              }, {\n                \"default\": _withCtx(function () {\n                  return _cache[8] || (_cache[8] = [_createTextVNode(\" Delete \")]);\n                }),\n                _: 2 /* DYNAMIC */\n              }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"])];\n            }),\n            _: 1 /* STABLE */\n          })];\n        }),\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"data\"])), [[_directive_loading, $setup.loading]]), _createCommentVNode(\" Empty state \"), $setup.classes.length === 0 && !$setup.loading ? (_openBlock(), _createBlock(_component_el_empty, {\n        key: 0,\n        description: \"No classes found\"\n      }, {\n        \"default\": _withCtx(function () {\n          return [_createVNode(_component_el_button, {\n            type: \"primary\",\n            onClick: _cache[1] || (_cache[1] = function ($event) {\n              return _ctx.$router.push('/classes/new');\n            })\n          }, {\n            \"default\": _withCtx(function () {\n              return _cache[9] || (_cache[9] = [_createTextVNode(\" Create First Class \")]);\n            }),\n            _: 1 /* STABLE */\n          })];\n        }),\n        _: 1 /* STABLE */\n      })) : _createCommentVNode(\"v-if\", true)];\n    }),\n    _: 1 /* STABLE */\n  }), _createCommentVNode(\" Delete Confirmation Dialog \"), _createVNode(_component_el_dialog, {\n    modelValue: $setup.deleteDialog.visible,\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = function ($event) {\n      return $setup.deleteDialog.visible = $event;\n    }),\n    title: \"Confirm Delete\",\n    width: \"30%\"\n  }, {\n    footer: _withCtx(function () {\n      var _$setup$deleteDialog$;\n      return [_createElementVNode(\"span\", _hoisted_4, [_createVNode(_component_el_button, {\n        onClick: _cache[2] || (_cache[2] = function ($event) {\n          return $setup.deleteDialog.visible = false;\n        })\n      }, {\n        \"default\": _withCtx(function () {\n          return _cache[12] || (_cache[12] = [_createTextVNode(\"Cancel\")]);\n        }),\n        _: 1 /* STABLE */\n      }), _createVNode(_component_el_button, {\n        type: \"danger\",\n        onClick: $setup.deleteClass,\n        loading: $setup.deleteDialog.loading,\n        disabled: ((_$setup$deleteDialog$ = $setup.deleteDialog[\"class\"]) === null || _$setup$deleteDialog$ === void 0 ? void 0 : _$setup$deleteDialog$.student_count) > 0\n      }, {\n        \"default\": _withCtx(function () {\n          return _cache[13] || (_cache[13] = [_createTextVNode(\" Delete \")]);\n        }),\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"onClick\", \"loading\", \"disabled\"])])];\n    }),\n    \"default\": _withCtx(function () {\n      var _$setup$deleteDialog$2, _$setup$deleteDialog$3;\n      return [_createElementVNode(\"span\", null, [_createTextVNode(\" Are you sure you want to delete class \\\"\" + _toDisplayString((_$setup$deleteDialog$2 = $setup.deleteDialog[\"class\"]) === null || _$setup$deleteDialog$2 === void 0 ? void 0 : _$setup$deleteDialog$2.name) + \"\\\"? \", 1 /* TEXT */), _cache[10] || (_cache[10] = _createElementVNode(\"br\", null, null, -1 /* HOISTED */)), _cache[11] || (_cache[11] = _createElementVNode(\"br\", null, null, -1 /* HOISTED */)), ((_$setup$deleteDialog$3 = $setup.deleteDialog[\"class\"]) === null || _$setup$deleteDialog$3 === void 0 ? void 0 : _$setup$deleteDialog$3.student_count) > 0 ? (_openBlock(), _createElementBlock(\"strong\", _hoisted_3, \" Warning: This class has \" + _toDisplayString($setup.deleteDialog[\"class\"].student_count) + \" students. You cannot delete a class that has students. \", 1 /* TEXT */)) : _createCommentVNode(\"v-if\", true)])];\n    }),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"modelValue\"])]);\n}","map":{"version":3,"names":["key","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createVNode","_component_el_button","type","onClick","_cache","$event","_ctx","$router","push","_withCtx","_createTextVNode","_","_createCommentVNode","_component_el_card","_createBlock","_component_el_table","data","$setup","classes","style","border","_component_el_table_column","prop","label","sortable","width","fixed","scope","size","concat","row","id","confirmDelete","loading","length","_component_el_empty","description","_component_el_dialog","modelValue","deleteDialog","visible","title","footer","_$setup$deleteDialog$","_hoisted_4","deleteClass","disabled","student_count","_$setup$deleteDialog$2","_$setup$deleteDialog$3","_toDisplayString","name","_hoisted_3"],"sources":["E:\\GoLand20240404\\Project\\student_management\\frontend\\src\\views\\classes\\ClassList.vue"],"sourcesContent":["<template>\r\n  <div class=\"class-list-container\">\r\n    <div class=\"page-header\">\r\n      <h1 class=\"page-title\">Classes</h1>\r\n      <el-button type=\"primary\" @click=\"$router.push('/classes/new')\">\r\n        Add New Class\r\n      </el-button>\r\n    </div>\r\n    \r\n    <!-- Classes Table -->\r\n    <el-card>\r\n      <el-table \r\n        :data=\"classes\" \r\n        v-loading=\"loading\" \r\n        style=\"width: 100%\"\r\n        border\r\n      >\r\n        <el-table-column prop=\"name\" label=\"Class Name\" sortable />\r\n        <el-table-column prop=\"description\" label=\"Description\" show-overflow-tooltip />\r\n        <el-table-column prop=\"student_count\" label=\"Students\" width=\"100\" sortable />\r\n        <el-table-column label=\"Actions\" width=\"250\" fixed=\"right\">\r\n          <template #default=\"scope\">\r\n            <el-button \r\n              size=\"small\" \r\n              type=\"primary\" \r\n              @click=\"$router.push(`/classes/${scope.row.id}`)\"\r\n            >\r\n              View\r\n            </el-button>\r\n            <el-button \r\n              size=\"small\" \r\n              type=\"warning\" \r\n              @click=\"$router.push(`/classes/${scope.row.id}/edit`)\"\r\n            >\r\n              Edit\r\n            </el-button>\r\n            <el-button \r\n              size=\"small\" \r\n              type=\"danger\" \r\n              @click=\"confirmDelete(scope.row)\"\r\n            >\r\n              Delete\r\n            </el-button>\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      \r\n      <!-- Empty state -->\r\n      <el-empty \r\n        v-if=\"classes.length === 0 && !loading\" \r\n        description=\"No classes found\"\r\n      >\r\n        <el-button type=\"primary\" @click=\"$router.push('/classes/new')\">\r\n          Create First Class\r\n        </el-button>\r\n      </el-empty>\r\n    </el-card>\r\n    \r\n    <!-- Delete Confirmation Dialog -->\r\n    <el-dialog\r\n      v-model=\"deleteDialog.visible\"\r\n      title=\"Confirm Delete\"\r\n      width=\"30%\"\r\n    >\r\n      <span>\r\n        Are you sure you want to delete class \"{{ deleteDialog.class?.name }}\"?\r\n        <br><br>\r\n        <strong v-if=\"deleteDialog.class?.student_count > 0\" class=\"text-danger\">\r\n          Warning: This class has {{ deleteDialog.class.student_count }} students. \r\n          You cannot delete a class that has students.\r\n        </strong>\r\n      </span>\r\n      <template #footer>\r\n        <span class=\"dialog-footer\">\r\n          <el-button @click=\"deleteDialog.visible = false\">Cancel</el-button>\r\n          <el-button \r\n            type=\"danger\" \r\n            @click=\"deleteClass\" \r\n            :loading=\"deleteDialog.loading\"\r\n            :disabled=\"deleteDialog.class?.student_count > 0\"\r\n          >\r\n            Delete\r\n          </el-button>\r\n        </span>\r\n      </template>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, reactive, computed, onMounted } from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport { ElMessage } from 'element-plus'\r\n\r\nexport default {\r\n  name: 'ClassList',\r\n  setup() {\r\n    const store = useStore()\r\n    const loading = ref(false)\r\n    \r\n    // Get classes from store\r\n    const classes = computed(() => store.getters['classes/allClasses'])\r\n    \r\n    // Delete dialog state\r\n    const deleteDialog = reactive({\r\n      visible: false,\r\n      class: null,\r\n      loading: false\r\n    })\r\n    \r\n    // Fetch classes\r\n    const fetchClasses = async () => {\r\n      loading.value = true\r\n      try {\r\n        await store.dispatch('classes/fetchClasses')\r\n      } catch (error) {\r\n        console.error('Error fetching classes:', error)\r\n        ElMessage.error('Failed to load classes')\r\n      } finally {\r\n        loading.value = false\r\n      }\r\n    }\r\n    \r\n    // Delete class\r\n    const confirmDelete = (classData) => {\r\n      deleteDialog.class = classData\r\n      deleteDialog.visible = true\r\n    }\r\n    \r\n    const deleteClass = async () => {\r\n      if (!deleteDialog.class) return\r\n      \r\n      // Check if class has students\r\n      if (deleteDialog.class.student_count > 0) {\r\n        ElMessage.error('Cannot delete a class that has students')\r\n        return\r\n      }\r\n      \r\n      deleteDialog.loading = true\r\n      try {\r\n        await store.dispatch('classes/deleteClass', deleteDialog.class.id)\r\n        ElMessage.success('Class deleted successfully')\r\n        deleteDialog.visible = false\r\n      } catch (error) {\r\n        console.error('Error deleting class:', error)\r\n        if (error.response && error.response.status === 409) {\r\n          ElMessage.error('Cannot delete a class that has associated students')\r\n        } else {\r\n          ElMessage.error('Failed to delete class')\r\n        }\r\n      } finally {\r\n        deleteDialog.loading = false\r\n      }\r\n    }\r\n    \r\n    // Fetch data on component mount\r\n    onMounted(fetchClasses)\r\n    \r\n    return {\r\n      classes,\r\n      loading,\r\n      deleteDialog,\r\n      confirmDelete,\r\n      deleteClass\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.page-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 20px;\r\n}\r\n\r\n.text-danger {\r\n  color: #F56C6C;\r\n}\r\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}